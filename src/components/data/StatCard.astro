---
// DATA SOURCE: StatCard does not fetch data itself.
// It is a pure display primitive â€” the parent dashboard component
// owns the API fetch and passes individual values down as props.
//
// FETCH CALL LIVES IN: the persona dashboard component (e.g. BrokerDashboard.tsx)
//
//   useEffect(() => {
//     fetch('/api/broker/stats', {           // or /api/employer/stats, /api/member/stats
//       headers: { Authorization: `Bearer ${getSessionToken()}` }
//     })
//       .then(r => r.json())
//       .then(setStats);
//   }, []);
//
// The stats bundle is then split across multiple StatCard instances:
//   <StatCard label="Active Cases"  value={stats?.activeCases} sourceIcon="âš¡" sourceName="V3locity API" />
//   <StatCard label="MTD Premium"   value={stats?.mtdPremium}  sourceIcon="ðŸ—„" sourceName="SQL Server" />
//
// This pattern batches all KPIs into a single round-trip rather than
// having each card make its own fetch.

interface Props {
  label: string;
  value: string | number;
  sub?: string;
  sourceIcon: string;
  sourceName: string;
}
const { label, value, sub, sourceIcon, sourceName } = Astro.props;
// â†‘ prototype: values passed as props from the page
// â†‘ production: values passed as props from the parent dashboard after its fetch resolves
---

<div class="comp comp-data">
  <div class="comp-bar">
    <div class="comp-bar-left">
      <a href="/components/data/stat-card" target="_blank" class="comp-explain-link">{sourceIcon} Live Data â†—</a>
      <span style="opacity:0.4;">Â·</span>
      <span style="font-weight:500; text-transform:none; letter-spacing:0;">{sourceName}</span>
    </div>
    <span class="data-source">Stat Card</span>
  </div>
  <div class="comp-body">
    <div class="stat-label-sm">{label}</div>
    <div class="stat-value-lg" data-live>{value}</div>
    {sub && <div class="stat-sub-sm" set:html={sub}></div>}
  </div>
</div>
