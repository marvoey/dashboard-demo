---
import PortalLayout from '../layouts/PortalLayout.astro';
import activeCases from '../data/activeCases.json';
import PersonalizedHero from '../components/cms/PersonalizedHero.astro';
import AnnouncementBanner from '../components/cms/AnnouncementBanner.astro';
import ResourceDownload from '../components/cms/ResourceDownload.astro';
import SpotlightCard from '../components/cms/SpotlightCard.astro';
import StatCard from '../components/data/StatCard.astro';
import ActiveCasesTable from '../components/data/ActiveCasesTable.astro';

const totalEmployees = activeCases.reduce((sum, c) => sum + c.employees, 0);
const activeCount = activeCases.filter(c => c.status === 'Active').length;
const renewalDue = activeCases.filter(c => c.status === 'Renewal Due').length;
---


<PortalLayout title="Broker Dashboard" persona="broker">

  <div class="page-header">
    <h1>Good morning, Marvin ðŸ‘‹</h1>
    <p>Here's your book of business as of today. Data sourced from V3locity and SQL Server.</p>
  </div>

  <div class="page-grid">

    <PersonalizedHero
      eyebrow="Q2 2024 Â· Broker Portal"
      headline="Two new products are open for Q2 case submissions"
      subtext="Life+CareÂ® Hybrid and enhanced Critical Illness riders are now available. Submit new cases before the Q2 deadline to lock in current rates for your clients."
      ctaLabel="View Product Updates"
      ctaUrl="#"
      segment="broker"
      source="Optimizely â€” Targeted by Segment"
    />

    <AnnouncementBanner
      tag="Q2 Product Update"
      headline="New Life+CareÂ® Hybrid Product Now Available for Enrollment"
      body="Trustmark Life+CareÂ® is now open for Q2 case submissions. Enhanced LTC benefit riders available for groups 50+."
      ctaLabel="View Details â†’"
      ctaUrl="#"
      source="Optimizely â€” Managed by Marketing"
    />

    <StatCard
      label="Active Cases"
      value={activeCases.length}
      sub={`${activeCount} active Â· ${renewalDue} renewal due`}
      sourceIcon="âš¡"
      sourceName="V3locity API"
    />

    <StatCard
      label="Total Covered Employees"
      value={totalEmployees.toLocaleString()}
      sub="Across all employer groups"
      sourceIcon="ðŸ—„"
      sourceName="SQL Server"
    />

    <StatCard
      label="Monthly Premium Volume"
      value="$94,240"
      sub="+12% vs prior quarter"
      sourceIcon="âš¡"
      sourceName="V3locity API"
    />

    <ActiveCasesTable cases={activeCases} />

    <ResourceDownload
      tag="Submission Checklist"
      title="Q2 2024 Case Submission Checklist"
      description="Everything required to submit a new group case for Q2. Includes census format, required riders, and submission deadlines."
      fileType="PDF"
      fileSize="312 KB"
      assetUrl="#"
      updatedAt="Updated April 1, 2024"
      source="Optimizely DAM â€” Content Team"
    />

    <SpotlightCard
      tag="Featured"
      title="Life+CareÂ® Hybrid"
      description="Permanent life with integrated long-term care benefits. New enhanced riders for Q2 available now."
      source="Optimizely â€” Sales & Marketing"
    />

    <SpotlightCard
      tag="High Demand"
      title="Critical Illness"
      description="Lump-sum benefit on diagnosis of covered conditions. Expanded covered conditions list for 2024."
      source="Optimizely â€” Sales & Marketing"
    />

    <SpotlightCard
      tag="Training Available"
      title="Disability Income"
      description="Short and long-term DI solutions. New broker certification course now available in the learning portal."
      source="Optimizely â€” Sales & Marketing"
    />

  </div>

</PortalLayout>
